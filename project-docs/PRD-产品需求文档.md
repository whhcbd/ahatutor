# AhaTutor - 学科可视化交互解答平台 PRD
## 产品需求文档 (Product Requirements Document)

**版本**: v1.0
**文档日期**: 2026-01-28
**产品名称**: AhaTutor
**产品定位**: 基于AI的学科可视化交互式学习辅助平台

---

## 一、产品概述

### 1.1 产品愿景
打造一个"自然语言输入 + AI理解 + 实时可视化 + 交互探索"的学科学习平台，让用户通过对话式交互获得动态、可交互的知识可视化解答，实现真正的"顿悟时刻"(Aha Moment)。

### 1.2 核心价值
- **可视化理解**: 将抽象概念转化为动态、可交互的视觉呈现
- **个性化学习**: 基于用户知识掌握程度定制学习路径
- **科学记忆**: 融合费曼学习法、艾宾浩斯遗忘曲线等学习科学模型
- **即时反馈**: 追问、巩固、评估的闭环学习体验

### 1.3 目标用户
| 用户类型 | 核心需求 | 使用场景 |
|---------|---------|---------|
| **学生** | 快速理解难点、考前突击、长期系统学习 | 课后复习、考试备考、知识拓展 |
| **自学者** | 自主学习资源、个性化进度、深入理解 | 技能提升、兴趣学习 |
| **教师** | 备课辅助、教学可视化、动态题库生成 | 课堂教学设计、作业布置 |

---

## 二、产品架构

### 2.1 双模式设计

#### 模式一：短时记忆模式（速通模式）
**目标用户**: 考前突击、快速复习、即时答疑
**核心特点**:
- 客制化刷题
- 一站式互动解答（追问）
- 快速反馈
- 聚焦当前问题解决

#### 模式二：长时记忆模式（深度模式）
**目标用户**: 系统学习、深度研究、长期规划
**核心特点**:
- 专题式学习
- 知识图谱导航
- 艾宾浩斯遗忘曲线复习计划
- 学习进度追踪
- 知识掌握度评估

### 2.2 产品演进路线
```
MVP阶段 ──────────► 成长阶段 ──────────► 成熟阶段
   │                      │                      │
   ▼                      ▼                      ▼
学科可视化         多学科扩展              生态平台
互动解答           AI Agent增强            教师端
知识图谱           移动端适配              学校SaaS
```

---

## 三、核心功能模块

### 模块一：智能问答与可视化 (MVP核心)

#### 1.1 自然语言理解
**功能描述**: 用户通过自然语言提问，系统理解意图并解析需求

**核心能力**:
- 多学科问题识别（数学、物理、化学等）
- 问题类型分类（概念解释、计算求解、证明推导等）
- 实体提取（公式、参数、条件）
- 难度评估

**用户流程**:
```
用户输入: "为什么圆的面积是πr²?"
    ↓
系统处理: 语言预处理 → 意图识别 → 实体提取
    ↓
识别结果: 学科=数学几何, 类型=原理推导, 难度=中等
```

#### 1.2 知识检索与方案生成
**技术方案**: Graph RAG (检索增强生成)

**功能特性**:
- 基于知识图谱的语义检索
- 多种解答方案匹配（如：阿基米德证法、积分证法、极限逼近法）
- LLM生成结构化解答方案
- 历史案例复用

**输出示例**:
```json
{
  "解答策略": "几何逼近法",
  "步骤": [
    {"step": 1, "内容": "将圆分割成n个扇形"},
    {"step": 2, "内容": "将扇形重排成近似矩形"},
    {"step": 3, "内容": "矩形面积 = 底×高 = πr×r"},
    {"step": 4, "内容": "n→∞时，面积精确等于πr²"}
  ],
  "可视化需求": ["圆分割动画", "重排动画", "极限过程"]
}
```

#### 1.3 动态可视化渲染
**核心功能**: 根据解答方案自动生成交互式可视化内容

**支持的可视化类型**:
| 问题类型 | 可视化方式 | 技术栈 |
|---------|-----------|--------|
| 几何证明 | Canvas 2D / SVG 动画 | D3.js, Rough.js |
| 函数图像 | 交互式图表 | D3.js, ECharts |
| 物理模拟 | 2D/3D 动画 | Matter.js, Three.js |
| 化学分子 | 3D 分子模型 | 3Dmol.js |
| 数据统计 | 动态图表 | Observable Plot |

**交互特性**:
- 参数调节（滑块、输入框）
- 步骤控制（播放/暂停/步进）
- 视角切换（2D/3D）
- 元素拖拽与高亮

**前端示例**:
```jsx
function CircleAreaProof({ segments = 8 }) {
  const [n, setN] = useState(segments);
  const [step, setStep] = useState(0);

  return (
    <div>
      <canvas ref={canvasRef} />
      <Slider value={n} onChange={setN} />
      <StepControls currentStep={step} onChange={setStep} />
    </div>
  );
}
```

#### 1.4 交互控制面板
**功能组件**:

**播放控制**:
- ⏮️ ⏪ ▶️ ⏩ ⏭️ 播放控制
- 播放速度调节（0.5x - 2x）

**参数调整**:
- 分割数量 n: [====●=======] 8
- 圆半径 r: [=======●====] 5
- 显示辅助线: [✓]

**探索模式**:
- [切换证明方法 ▼]
- [查看相关概念]

**实时反馈**:
- 参数调整后即时重新渲染
- 操作提示与引导

---

### 模块二：对话式学习与追问

#### 2.1 上下文追问
**功能描述**: 支持基于当前问题的连续追问

**场景示例**:
```
用户: "为什么圆的面积是πr²?"
系统: [生成可视化解答]
用户: "那球的体积公式怎么推导?"
系统: [延续几何主题，从2D扩展到3D，生成新的3D可视化]
```

**技术特性**:
- 对话历史上下文保持
- 知识关联识别（圆面积 → 球体积）
- 难度递进控制

#### 2.2 知识图谱导航
**功能**: 可视化展示知识点关联，支持知识探索

**实现**:
```
    ┌─────────┐
    │ 圆面积   │ ← 当前位置
    └────┬────┘
┌────────┼────────┐
▼        ▼        ▼
┌───────┐┌───────┐┌───────┐
│扇形面积││弧长公式││球体积 │
└───────┘└───────┘└───────┘
```

**交互**:
- 点击节点跳转到相关知识点
- 推荐学习路径
- 前置/后置知识提示

---

### 模块三：智能练习与巩固

#### 3.1 出题巩固
**功能**: 基于当前问题生成巩固练习

**特性**:
- 自动生成同类题目
- 难度自适应（根据用户表现调整）
- 多题型支持（选择、填空、证明、计算）

**流程**:
```
完成学习 → 生成3-5道巩固题 → 用户作答 → AI评估 → 错题解析
```

#### 3.2 知识掌握度评估
**评估维度**:
- 概念理解准确度
- 解题速度
- 错误类型分析
- 追问质量

**输出**:
```
知识点: 圆的面积公式
掌握度: 85%
薄弱点: 极限思想理解
建议: 复习微积分基础 → 练习极限相关题目
```

---

### 模块四：学习计划与记忆管理

#### 4.1 艾宾浩斯遗忘曲线复习
**功能**: 基于遗忘曲线智能安排复习

**复习时间点**:
- 5分钟后、30分钟后、12小时后、1天后、2天后、4天后、7天后、15天后

**实现**:
```
学习新知识 → 记录学习时间 → 计算复习节点 → 到期提醒
```

#### 4.2 费曼学习法融合
**核心理念**: "以教代学"

**功能**:
- 让用户用自己的话解释概念
- AI评估解释的准确性和完整性
- 指出理解盲区
- 提供优化建议

**交互示例**:
```
系统: "你能用自己的话解释为什么圆的面积是πr²吗？"
用户: "就是把圆切成很多小扇形，然后拼成一个近似矩形..."
AI评估: "理解正确！补充建议：强调'无限分割'和'极限'的概念..."
```

#### 4.3 个性化学习路径
**输入**:
- 用户目标（考试/兴趣/研究）
- 可用时间
- 当前知识水平

**输出**:
- 每日学习计划
- 里程碑节点
- 复习日程表

---

### 模块五：教师辅助功能（后期延展）

#### 5.1 备课辅助
**功能**:
- 输入教学主题 → 生成教学大纲
- 自动生成可视化教学方案
- 推荐经典例题与变式
- 生成板书设计建议

#### 5.2 动态题库生成
**特性**:
- 按知识点组卷
- 难度分布控制
- 自定义题目参数
- 导出标准格式（PDF/Word/LaTeX）

#### 5.3 学生学情分析
**数据可视化**:
- 班级整体掌握度热力图
- 个体学习轨迹
- 薄弱知识点统计
- 学习时长分布

---

## 四、MVP范围界定

### 4.1 MVP版本（v1.0）

**学科范围**: 单一学科

**功能清单**:
- ✅ 自然语言提问
- ✅ 问题理解与意图识别
- ✅ 基础知识检索
- ✅ 可视化动画生成
- ✅ 交互参数调节
- ✅ 简单追问
- ✅ 知识点收藏

**不包含**:
- ❌ 知识图谱可视化
- ❌ 学习计划制定
- ❌ 教师端功能
- ❌ 移动端

### 4.2 功能优先级

| 优先级 | 功能模块 | 理由 |
|-------|---------|------|
| P0 | 自然语言问答 + 可视化 | 核心价值验证 |
| P0 | 基础交互控制 | 用户体验关键 |
| P1 | 追问功能 | 提升学习深度 |
| P1 | 出题巩固 | 学习闭环 |
| P2 | 知识图谱 | 长期价值 |
| P2 | 学习计划 | 用户留存 |
| P3 | 教师端 | 商业化延展 |

---

## 五、非功能性需求

### 5.1 性能要求
- 问答响应时间: < 3秒
- 可视化渲染: < 2秒
- 页面加载时间: < 1.5秒
- 并发支持: MVP阶段 100 QPS

### 5.2 安全性
- 生成代码沙箱隔离（防止恶意代码执行）
- 用户数据加密存储
- API密钥安全管理
- 输入内容过滤（防止注入攻击）

### 5.3 可用性
- 系统可用性: 99.5%
- 界面简洁直观，中学生可用
- 多浏览器支持（Chrome, Firefox, Safari, Edge）
- 响应式设计（适配平板）

### 5.4 可扩展性
- 模块化架构，便于新增学科
- 可视化组件库复用
- 插件式AI模型接入

---

## 六、技术架构

### 6.1 整体架构图
```
┌─────────────────────────────────────────────────────────────────────┐
│                         用户端 (Web前端)                              │
├─────────────────────────────────────────────────────────────────────┤
│  自然语言输入 → 可视化展示区 → 交互控制面板 → 历史记录/收藏          │
└──────────────────────────────┬──────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         核心处理层                                    │
├─────────────────────────────────────────────────────────────────────┤
│  ┌──────────┐    ┌──────────┐    ┌──────────┐    ┌──────────┐       │
│  │ 问题理解  │ →  │ 知识匹配  │ →  │ 方案生成  │ →  │ 代码生成  │       │
│  │  (NLU)   │    │  (RAG)   │    │ (LLM)    │    │(可视化)  │       │
│  └──────────┘    └──────────┘    └──────────┘    └──────────┘       │
└──────────────────────────────┬──────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────┐
│                      可视化渲染引擎                                    │
├─────────────────────────────────────────────────────────────────────┤
│  动画渲染 | 公式渲染 | 图表渲染 | 交互组件                            │
└─────────────────────────────────────────────────────────────────────┘
```

### 6.2 技术栈选型

#### 前端层
- **框架**: React 18 + TypeScript
- **可视化**:
  - D3.js (数据可视化)
  - Rough.js (手绘风格几何图形)
  - KaTeX (数学公式渲染)
- **动画**: Framer Motion / GSAP
- **代码沙箱**: iframe + postMessage
- **状态管理**: Zustand / Redux Toolkit

#### 后端层
- **框架**: Node.js (NestJS) / Python (FastAPI)
- **LLM接入**:
  - OpenAI GPT-4 / Anthropic Claude
  - Azure OpenAI (国内部署)
- **向量数据库**: Pinecone / Weaviate
- **图数据库**: Neo4j (知识图谱)
- **缓存**: Redis (常见问题缓存)

#### AI层
- **RAG框架**: LangChain / LlamaIndex
- **Graph RAG**: Microsoft GraphRAG
- **Prompt Engineering**: 多阶段提示（理解→检索→规划→生成）
- **Fine-tuning**: 学科专用微调模型（可选）

---

## 七、数据模型

### 7.1 核心实体

#### User (用户)
```
- user_id: string
- username: string
- email: string
- role: 'student' | 'teacher' | 'admin'
- knowledge_level: Map<subject, level>
- learning_mode: 'short_term' | 'long_term'
- created_at: timestamp
```

#### Question (问题)
```
- question_id: string
- user_id: string
- content: string (自然语言)
- subject: string
- topic: string
- difficulty: number
- intent: string
- entities: object
- created_at: timestamp
```

#### Answer (解答)
```
- answer_id: string
- question_id: string
- solution_strategy: string
- steps: Array<{step, content, visualization}>
- code_snippet: string (可视化代码)
- explanation: string
- related_topics: Array<string>
- created_at: timestamp
```

#### KnowledgeNode (知识节点)
```
- node_id: string
- subject: string
- topic: string
- description: string
- prerequisites: Array<string>
- related_nodes: Array<string>
- difficulty: number
- visualization_templates: Array<string>
```

#### UserProgress (用户进度)
```
- progress_id: string
- user_id: string
- topic_id: string
- mastery_level: number (0-100)
- last_reviewed: timestamp
- next_review: timestamp
- review_count: number
```

---

## 八、用户体验流程

### 8.1 核心用户旅程

#### 旅程1: 速通模式 - 考前突击
```
1. 用户输入: "我明天要考圆和椭圆，快速复习"
   ↓
2. 系统生成复习计划（重点知识点 + 典型题型）
   ↓
3. 逐个知识点展示可视化讲解
   ↓
4. 每个知识点后出2-3道巩固题
   ↓
5. 错题自动加入复习队列
   ↓
6. 完成后生成掌握度报告
```

#### 旅程2: 深度模式 - 系统学习
```
1. 用户设定学习目标: "一个月内掌握微积分基础"
   ↓
2. 系统生成学习路径（知识图谱 + 里程碑）
   ↓
3. 每日推送学习任务
   ↓
4. 学习过程中记录疑问和追问
   ↓
5. 按遗忘曲线安排复习提醒
   ↓
6. 定期评估掌握度，调整进度
```

### 8.2 界面原型要点

#### 主界面布局
```
┌─────────────────────────────────────────────────────┐
│  AhaTutor                          [模式切换] [用户] │
├─────────────────────────────────────────────────────┤
│                                                      │
│  ┌───────────────────────────────────────────────┐  │
│  │ 请输入你的问题...                              │  │
│  │ [为什么圆的面积是πr²？]          [提问] 🎤     │  │
│  └───────────────────────────────────────────────┘  │
│                                                      │
│  ┌───────────────────────────────────────────────┐  │
│  │              可视化展示区                      │  │
│  │                                                │  │
│  │            🔵 圆的分割动画                     │  │
│  │                                                │  │
│  └───────────────────────────────────────────────┘  │
│                                                      │
│  ┌───────────────────────────────────────────────┐  │
│  │ 步骤解说: 将圆分割成8个相等的扇形...           │  │
│  └───────────────────────────────────────────────┘  │
│                                                      │
│  ┌───────────────────────────────────────────────┐  │
│  │  ⏮️  ⏪  ▶️  ⏩  ⏭️     参数: n=[8] r=[5]      │  │
│  └───────────────────────────────────────────────┘  │
│                                                      │
│  [追问] [收藏] [出题练习] [相关知识点]                │
└─────────────────────────────────────────────────────┘
```

---

## 九、成功指标 (KPIs)

### 9.1 MVP阶段指标
| 指标 | 目标值 | 测量方式 |
|-----|-------|---------|
| 用户留存率 (7日) | > 40% | 数据分析 |
| 问答准确率 | > 85% | 用户反馈 |
| 平均响应时间 | < 3秒 | 系统监控 |
| 日活用户 (DAU) | > 100 | 统计分析 |
| 用户满意度 (NPS) | > 50 | 问卷调研 |

### 9.2 核心验证假设
1. **价值假设**: 可视化交互能显著提升学习理解效率
   - **验证**: A/B测试（可视化 vs 纯文字）
2. **用户假设**: 学生愿意为即时答疑+可视化付费
   - **验证**: 付费转化率调研
3. **增长假设**: 追问功能能提高用户粘性
   - **验证**: 追问使用频率 vs 用户留存

---

## 十、风险与挑战

### 10.1 技术风险
| 风险 | 影响 | 应对策略 |
|-----|------|---------|
| LLM生成代码质量不稳定 | 可视化渲染失败 | 代码模板库 + 静态检测 |
| RAG检索准确率不足 | 解答质量差 | 知识图谱优化 + 人工审核 |
| 可视化组件性能问题 | 页面卡顿 | 懒加载 + 虚拟滚动 |
| 并发量增长导致成本激增 | 运营不可持续 | Redis缓存 + CDN |

### 10.2 产品风险
| 风险 | 应对 |
|-----|------|
| 用户对AI解答缺乏信任 | 引入专家审核机制 |
| 学科知识库覆盖不足 | 先聚焦数学几何，验证后扩展 |
| 用户提问超出能力范围 | 明确边界 + 人工介入 |
| 同质化竞争 | 强化"交互式可视化"差异化 |

### 10.3 商业风险
| 风险 | 应对 |
|-----|------|
| 获客成本高 | 口碑传播 + 校园推广 |
| 付费意愿低 | Freemium模式 |
| LLM API成本过高 | 分层定价 + 缓存优化 |

---

## 十一、开发里程碑

### Phase 1: MVP开发 
- Week 1-2: 基础架构搭建 + NLU模块
- Week 3-4: RAG检索系统 + LLM方案生成
- Week 5-6: 可视化渲染引擎（2D几何动画）
- Week 7-8: 前端界面 + 集成测试

### Phase 2: 功能完善
- Week 9-10: 追问功能 + 知识图谱
- Week 11-12: 出题巩固 + 评估系统
- Week 13-14: 用户体验优化

### Phase 3: 正式发布
- Week 15-16: Beta测试 + Bug修复
- Week 17-18: 正式上线 + 运营准备

---

## 十二、附录

### 12.1 关键术语表
- **RAG (Retrieval-Augmented Generation)**: 检索增强生成，结合信息检索和LLM生成
- **Graph RAG**: 基于知识图谱的RAG，提升检索语义关联性
- **费曼学习法**: 通过"以教代学"检验理解程度的方法
- **艾宾浩斯遗忘曲线**: 揭示人类记忆遗忘规律的时间曲线
- **Agent**: 智能代理，能自主决策并执行复杂任务的AI系统

### 12.2 参考竞品
- 3Blue1Brown (可视化启发)
- Desmos (交互式图形计算器)
- GeoGebra (几何代数可视化)
- Brilliant.org (交互式学习)
- Khan Academy (知识体系)

### 12.3 文档变更记录
| 版本 | 日期 | 修订人 | 变更说明 |
|-----|------|-------|---------|
| v1.0 | 2026-01-28 | - | 初始版本 |

---

**文档结束**
